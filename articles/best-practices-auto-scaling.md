<properties
   pageTitle="AutoScaling conseils | Microsoft Azure"
   description="Conseils sur l’échelle pour allouer dynamiquement des ressources requises par une application."
   services=""
   documentationCenter="na"
   authors="dragon119"
   manager="christb"
   editor=""
   tags=""/>

<tags
   ms.service="best-practice"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="07/13/2016"
   ms.author="masashin"/>

# <a name="autoscaling-guidance"></a>AutoScaling conseils

[AZURE.INCLUDE [pnp-header](../includes/guidance-pnp-header-include.md)]

## <a name="overview"></a>Vue d’ensemble
AutoScaling est le processus de répartition dynamique des ressources requises par une application pour répondre aux exigences de performances et de satisfaire les contrats de niveau de service (SLA), tout en réduisant les coûts de l’exécution. Au fur et à mesure du volume de travail, une application peut nécessiter des ressources supplémentaires pour lui permettre d’exécuter ses tâches en temps voulu. Comme la demande slackens, les ressources peuvent être désalloués afin de réduire les coûts, tout en toujours maintenir des performances optimales et respecter les SLA.
AutoScaling tire parti de l’élasticité d’environnements hébergés nuage tout en allégeant la charge de gestion. Il le fait en réduisant la nécessité d’un opérateur pour surveiller les performances d’un système en permanence et de prendre des décisions sur l’ajout ou la suppression des ressources.
>[AZURE.NOTE] AutoScaling s’applique à toutes les ressources utilisées par une application, pas seulement les ressources de calcul. Par exemple, si votre système utilise des files d’attente de message pour envoyer et recevoir des informations, il peut créer des files d’attente supplémentaires qu’il met à l’échelle.

## <a name="types-of-scaling"></a>Types de mise à l’échelle
Mise à l’échelle généralement prend l’une des deux formes suivantes :

- **Vertical** (souvent appelé _et vers le bas jusqu'à la mise à l’échelle_). Ce formulaire requiert la modification du matériel (développer ou réduire sa capacité et performances), ou de redéployer la solution à l’aide d’un matériel de secours qui a la capacité appropriée et les performances. Dans un environnement de cloud, la plate-forme matérielle est généralement un environnement virtualisé. Sauf si le matériel d’origine a été sensiblement overprovisioned, avec les dépenses d’investissement initial qui s’imposent, verticalement l’évolution verticale dans cet environnement implique provisionnement des ressources plus puissants, puis en déplaçant le système sur ces nouvelles ressources. Mise à l’échelle verticale est souvent un processus d’interruption de l’activité qui implique que le système soit temporairement indisponible pendant qu’il est redéployé. Il peut être possible de conserver le système d’origine est en cours d’exécution alors que le nouveau matériel est mis en service et mise en ligne, mais il sera sans doute une interruption pendant les transitions de traitement à partir de l’environnement ancien vers le nouveau. Il est rare d’autoscaling permet de mettre en œuvre une stratégie de mise à l’échelle verticale.
- **Horizontal** (souvent appelé _mise à l’échelle à l’extraction et_). Ce formulaire requiert le déploiement de la solution la plus ou moins de ressources, qui sont en général des ressources de la marchandise au lieu de systèmes à forte consommation. La solution peut continuer à s’exécuter sans interruption pendant que ces ressources sont mis en service. Lorsque le processus de configuration est terminé, les copies des éléments qui composent la solution peuvent être déployées sur ces ressources supplémentaires et accessibles. Si la demande est, les ressources supplémentaires peuvent être libérées après que les éléments à l’aide de leur ont été arrêtés correctement. De nombreux systèmes en nuage, y compris Microsoft Azure, prend en charge l’automatisation de cette forme de mise à l’échelle.

## <a name="implement-an-autoscaling-strategy"></a>Mettre en œuvre une stratégie autoscaling
L’implémentation d’une stratégie autoscaling généralement implique les composants et les processus suivants :

- Instrumentation et la surveillance des systèmes de niveaux de service, application et infrastructure. Ces systèmes capturent des métriques clés, tels que les temps de réponse, les longueurs de file d’attente, utilisation de l’UC et utilisation de la mémoire.
- Logique de prise de décision qui peut évaluer les facteurs d’échelle surveillés par rapport à des seuils de système prédéfinis ou des planifications et prendre des décisions quant à l’échelle ou non.
- Composants qui sont chargés d’effectuer les tâches associées à l’échelle du système, telles que la mise en service ou de mise hors service de ressources.
- Test, la surveillance et réglage de la stratégie autoscaling pour s’assurer qu’il fonctionne comme prévu.

La plupart des environnements de nuage, par exemple d’Azure, fournissent des mécanismes d’autoscaling intégré qui adresse les scénarios courants. Si l’environnement ou le service que vous utilisez ne fournit pas que nécessaires automatisée des fonctionnalités de mise à l’échelle, ou si vous avez des exigences extrêmes autoscaling au-delà de ses capacités, une implémentation personnalisée peut être nécessaire. Cette implémentation personnalisée permet de recueillir opérationnels et les mesures du système, les analyser pour identifier les données pertinentes et puis adapter les ressources en conséquence.


## <a name="configure-autoscaling-for-an-azure-solution"></a>Configurer autoscaling pour une solution Azure
Il existe plusieurs options de configuration autoscaling pour vos solutions d’Azure :

- **Échelle d’Azure** prend en charge les scénarios les plus courants mise à l’échelle en fonction d’une planification et, éventuellement, déclenché la mise à l’échelle des opérations basées sur des mesures d’exécution (par exemple, l’utilisation du processeur, longueur de la file d’attente ou les compteurs intégrés et personnalisés). Vous pouvez configurer des stratégies autoscaling simple pour une solution rapidement et facilement à l’aide du portail Azure. Pour un contrôle plus détaillé, vous pouvez rendre l’utilisation de l' [API REST de Azure Service gestion](https://msdn.microsoft.com/library/azure/ee460799.aspx) ou l' [REST API de gestionnaire de ressources Azure](https://msdn.microsoft.com//library/azure/dn790568.aspx). La [Bibliothèque de gestion des services de surveillance Azure](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring) et la [Bibliothèque d’aperçu](https://www.nuget.org/packages/Microsoft.Azure.Insights/) (en aperçu) sont les kits de développement logiciel qui autorisent la collecte des mesures à partir des ressources différentes et d’effectuent des autoscaling en utilisant des API reste. Pour les ressources dans le cas où la prise en charge du Gestionnaire de ressources Azure n’est pas disponible, ou si vous utilisez des Services en nuage Azure, l’API REST de gestion de Service peut être utilisé pour autoscaling. Dans tous les autres cas, utilisez le Gestionnaire de ressources Azure.
- **Une solution personnalisée**, basée sur votre instrumentation de l’application et les fonctionnalités de gestion d’Azure, peut être utile. Par exemple, vous pouvez utiliser les diagnostics de Windows Azure ou d’autres méthodes d’instrumentation dans votre application, avec un code personnalisé pour surveiller en permanence et d’exporter des métriques de l’application. Vous pouvez avoir des règles personnalisées qui fonctionnent sur ces métriques et utiliser la gestion des services ou de le REST API de gestionnaire de ressources pour déclencher autoscaling. Les mesures pour le déclenchement d’une opération de mise à l’échelle peuvent être n’importe quel compteur prédéfini ou personnalisé, ou autre instrument que vous implémentez au sein de l’application. Toutefois, une solution personnalisée n’est pas simple à implémenter et doit être considérée comme uniquement si aucune des méthodes précédentes peuvent répondre à vos besoins. Le [Bloc d’Application Autoscaling](http://msdn.microsoft.com/library/hh680892%28v=pandp.50%29.aspx) utilise cette approche.
- **Les services tiers**, tels que les [Paraleap AzureWatch](http://www.paraleap.com/AzureWatch), permettent de faire évoluer une solution basée sur les planifications, les indicateurs de performance de charge et système de service, des règles personnalisées et des combinaisons de différents types de règles.

Lorsque vous choisissez d’autoscaling de la solution à adopter, tenez compte des points suivants :

- Utiliser les fonctionnalités d’autoscaling intégré de la plate-forme, si elles peuvent répondre à vos besoins. Si ce n’est pas le cas, étudiez attentivement si vous avez réellement besoin des fonctionnalités de mise à l’échelle plus complexes. Voici quelques exemples de conditions requises supplémentaires peuvent inclure plus de granularité de contrôle, les différentes manières de détecter les événements déclencheurs de mise à l’échelle mise à l’échelle entre les abonnements et les autres types de ressources de mise à l’échelle.
- Considérez si vous pouvez prévoir la charge de l’application avec une précision suffisante dépende uniquement d’autoscaling planifiée (ajout et suppression d’instances pour répondre aux pointes de la demande anticipées). Où ce n’est pas possible, utilisez autoscaling réactif selon des métriques recueillies lors de l’exécution, pour autoriser l’application à gérer des modifications imprévisibles dans la demande. En règle générale, vous pouvez combiner ces approches. Par exemple, créer une stratégie qui ajoute les ressources de calcul, de stockage et de files d’attente, en fonction d’un calendrier des fois lorsque vous connaissez que l’application n’est plus occupée. Cela permet de s’assurer que la capacité est disponible à la demande, sans retard rencontré lors du démarrage de nouvelles instances. En outre, pour chaque règle planifiée, définir des mesures qui permettent autoscaling réactif pendant cette période, pour s’assurer que l’application peut gérer des pointes soutenues mais imprévisibles de la demande.
- Il est souvent difficile de comprendre la relation entre les besoins de capacité et de mesures, en particulier lorsqu’une application est initialement déployée. Vous souhaitez provisionner une capacité supplémentaire au début, un peu, puis surveiller et régler les règles autoscaling pour amener la capacité plus près à la charge réelle.

### <a name="use-azure-autoscale"></a>Utiliser l’échelle Azure
Échelle automatique vous permet de configurer mise à l’échelle et de mettre à l’échelle dans les options d’une solution. Échelle automatique peut automatiquement ajouter et supprimer des instances de web de Services en nuage Azure et rôles worker, Azure Mobile Services et fonctionnalité d’applications Web dans le Service d’application Azure. Elle peut également permettre la mise à l’échelle automatique par le démarrage et l’arrêt des instances d’Azure Virtual Machines. Une stratégie autoscaling Azure comprend deux ensembles de facteurs :

- Autoscaling planification garantissant des instances supplémentaires sont disponibles pour coïncider avec un pic attendu dans l’utilisation et à faire évoluer une fois l’heure maximale est dépassée. Cela vous permet de vous assurer que vous disposez des instances en cours d’exécution, sans attendre que le système de réagir à la charge.
- Autoscaling, basé sur des métriques qui réagit à des facteurs tels que l’utilisation CPU moyenne sur la dernière heure ou de la file d’attente de messages que la solution s’exécute dans un stockage Azure ou une file d’attente du Bus des services Azure. Cela permet à l’application de réagir séparément à partir des règles autoscaling planifiée pour s’adapter aux changements non planifiés ou imprévus de la demande.

Tenez compte des points suivants lors de l’utilisation d’échelle automatique :

- Votre stratégie autoscaling combine la mise à l’échelle planifiées et basée sur des mesures. Vous pouvez spécifier deux types de règles pour un service.
- Configurer les règles autoscaling et ensuite de surveiller les performances de votre application dans le temps. Les résultats de cette surveillance permet d’ajuster la façon dont le système évolue si nécessaire. Cependant, gardez à l’esprit qu’autoscaling n’est pas un processus instantané. Le temps de réagir à une mesure telle que moyenne UC l’utilisation supérieure à (ou au-dessous) est un seuil spécifié.
- AutoScaling les règles qui utilisent un mécanisme de détection basé sur un attribut mesuré déclencheur (comme longueur de file d’attente ou l’utilisation du processeur) permet une valeur agrégée sur, au lieu de valeurs instantanées, déclenchent une action autoscaling. Par défaut, l’agrégat est une moyenne des valeurs. Cela empêche le système de réponse trop rapidement, ou à l’origine d’oscillation rapide. Il permet également de temps pour les nouvelles instances qui sont automatiquement démarrés à régler dans l’exécution du mode, empêchant les actions supplémentaires autoscaling durant les nouvelles instances sont en cours de route. Pour les Services en nuage Azure et les Machines virtuelles de Azure, la période pour l’agrégation par défaut est 45 minutes, donc il peut prendre cette période de temps pour la mesure de déclencher autoscaling en réponse aux pics de la demande. Vous pouvez modifier la période de globalisation en utilisant le Kit de développement, mais gardez à l’esprit que les périodes de moins de 25 minutes peuvent provoquer des résultats imprévisibles (pour plus d’informations, voir [Services en nuage mise à l’échelle automatique sur le pourcentage de processeur avec la bibliothèque de gestion des Services de surveillance Azure](http://rickrainey.com/2013/12/15/auto-scaling-cloud-services-on-cpu-percentage-with-the-windows-azure-monitoring-services-management-library/)). Pour les applications Web, la période moyenne est beaucoup plus courte, permettant ainsi de nouvelles instances être disponible dans environ cinq minutes après une modification à la mesure moyenne de déclencheur.
- Si vous configurez autoscaling à l’aide du Kit de développement, et non le portail web, vous pouvez spécifier une planification plus détaillée au cours de laquelle les règles sont actives. Vous pouvez également créer vos propres mesures et les utiliser avec ou sans un de ceux existant dans vos règles autoscaling. Par exemple, vous souhaitez utiliser d’autres compteurs, tels que le nombre de demandes par seconde ou la disponibilité de la mémoire moyenne, ou utiliser des compteurs personnalisés qui mesurent des processus d’entreprise.
- Lorsque autoscaling ordinateurs virtuels Azure, vous devez déployer un nombre d’instances de l’ordinateur virtuel qui est égal au nombre maximum vous permettra d’autoscaling Démarrer. Ces instances doivent appartenir au même jeu de disponibilité. Le mécanisme autoscaling de Machines virtuelles ne pas créer ou supprimer des instances de l’ordinateur virtuel ; au lieu de cela, les règles autoscaling que vous configurez Démarrez, arrêtez un nombre approprié de ces instances. Pour plus d’informations, reportez-vous à [redimensionner automatiquement une application Web rôles, rôles de travail ou Machines virtuelles en cours d’exécution](./cloud-services/cloud-services-how-to-scale.md).
- Si les nouvelles instances ne peut pas être démarrés, peut-être parce que la valeur maximale pour un abonnement a été atteint ou une erreur se produit lors du démarrage, le portail peut indiquer qu’une opération autoscaling a réussi. Toutefois, les événements ultérieurs **ChangeDeploymentConfiguration** affichées dans le portail affiche uniquement qu’un démarrage du service a été demandé et il n’y aura aucun événement pour indiquer qu’il s’est correctement terminé.
- Vous pouvez utiliser l’interface utilisateur du portail web à lier des ressources telles que les instances de base de données SQL et les files d’attente à une instance de service de calcul. Cela vous permet d’accéder plus facilement aux particulières manuelles et automatiques de mise à l’échelle des options de configuration pour chaque ressource liée. Pour plus d’informations, consultez [Comment : lier une ressource à un service en nuage](cloud-services-how-to-manage.md#linkresources) et la [façon de mettre à l’échelle d’une Application](./cloud-services/cloud-services-how-to-scale.md).
- Lorsque vous configurez plusieurs stratégies et des règles, ils peuvent entrer en conflit entre eux. Échelle automatique utilise les règles de résolution de conflit suivant pour s’assurer qu’il existe toujours un nombre suffisant d’instances en cours d’exécution :
  - Échelle des opérations ont toujours la priorité sur l’échelle dans les opérations.
  - Lorsque mise à l’échelle en conflit des opérations, la règle qui initie la plus forte augmentation du nombre d’instances est prioritaire.
  - Lorsque mise à l’échelle en conflit des opérations, la règle qui initie la plus petite baisse dans le nombre d’instances est prioritaire.

<a name="the-azure-monitoring-services-management-library"></a>

## <a name="application-design-considerations-for-implementing-autoscaling"></a>Considérations de conception d’application pour la mise en œuvre d’autoscaling
AutoScaling n’est pas une solution instantanée. Simplement ajouter des ressources à un système ou l’exécution de plusieurs instances d’un processus ne garantit pas qu’améliorer les performances du système. Lorsque vous concevez une stratégie autoscaling, tenez compte des points suivants :

- Le système doit être conçu pour être évolutif horizontalement. Évitez de faire des hypothèses sur l’affinité d’instance ; ne concevez pas les solutions qui requièrent que le code est toujours en cours d’exécution dans une instance spécifique d’un processus. Lors de la mise à l’échelle un site web ou un service en nuage horizontalement, ne pensez pas qu’une série de demandes de la même source doit toujours être routée vers la même instance. Pour la même raison, les services sans état pour éviter une série de requêtes à partir d’une application pour toujours être routés vers la même instance d’un service de conception. Lorsque vous créez un service qui lit les messages à partir d’une file d’attente et les traite, ne pas faire de suppositions sur l’instance de service poignées un message spécifique. AutoScaling a pu démarrer des instances supplémentaires d’un service que la longueur de la file d’attente augmente. Le [Modèle de consommateurs en concurrence](http://msdn.microsoft.com/library/dn568101.aspx) explique comment gérer ce scénario.
- Si la solution met en œuvre une tâche longue, concevoir cette tâche pour prendre en charge à la fois la mise à l’échelle et mise à l’échelle dans. Sans échéance soins, une telle tâche pourrait empêcher une instance d’un processus en cours d’arrêt proprement lorsque le système évolue dans, ou il peut perdre des données si le processus est interrompu de force. Dans l’idéal, refactoriser une tâche longue et diviser le traitement qu’il exécute en segments plus petits et discrètes. Les [tuyaux et les filtres de modèle](http://msdn.microsoft.com/library/dn568100.aspx) fournit un exemple de la façon dont vous pouvez y parvenir.
- Vous pouvez également implémenter un mécanisme de point de vérification que les enregistrements de l’état d’informations sur la tâche à intervalles réguliers et enregistrement cet état dans le stockage durable qui est accessible par n’importe quelle instance du processus exécutant la tâche. De cette façon, si le processus est arrêté, le travail qu’il effectuait peut reprendre à partir du dernier point de contrôle à l’aide d’une autre instance.
- Lorsque les tâches en arrière-plan s’exécuter sur les instances de calcul distinctes, telles que les rôles des services en nuage hébergée travailleur application, vous devrez peut-être mettre à l’échelle des différentes parties de l’application à l’aide de stratégies de mise à l’échelle différents. Par exemple, vous devrez peut-être déployer compute de l’interface (interface utilisateur) utilisateur supplémentaires instances sans augmenter le numéro de l’arrière-plan de calculent des instances, ou à l’opposé de ce. Si vous souhaitez proposer différents niveaux de service (service de base et haut de gamme, par exemple), vous devrez peut-être faire évoluer les ressources de calcul pour les packages de service premium d’une manière plus agressive que celles des services de base afin de respecter les SLA.
- Envisagez d’utiliser la longueur de la file d’attente sur laquelle l’interface utilisateur et l’arrière-plan de calcul communiquent des instances en tant que critère pour votre stratégie autoscaling. C’est le meilleur indicateur d’un déséquilibre ou la différence entre la charge et la capacité de traitement de la tâche en arrière-plan.
- Si vous basez votre stratégie autoscaling sur les compteurs qui mesurent les processus d’entreprise, telles que le nombre de commandes passées par l’heure ou la durée moyenne d’exécution d’une opération complexe, assurez-vous de bien comprendre la relation entre les résultats de ces types de compteurs et les besoins en capacité de calcul réel. Il peut être nécessaire de mettre à l’échelle plus d’un composant ou le calcul des unités en réponse aux modifications dans les compteurs de processus d’entreprise.  
- Pour empêcher un système d’essayer de faire évoluer excessive et pour éviter les coûts associés à des milliers d’instances en cours d’exécution, envisagez de limiter le nombre maximal d’instances qui peuvent être ajoutés automatiquement. La plupart des mécanismes autoscaling permettent de spécifier le nombre minimal et maximal d’instances d’une règle. En outre, envisagez normalement dégrader la fonctionnalité fournie par le système si le nombre maximal d’instances ont été déployé, et que le système est toujours surchargé.
- Gardez à l’esprit qu’autoscaling ne peut ne pas être le moyen le plus approprié pour gérer une soudaine de la charge de travail. Il prend du temps pour configurer et démarrer de nouvelles instances d’un service ou ajouter des ressources à un système, et les crêtes de demande peut avoir passé au moment où que ces ressources supplémentaires ont été apportées à la disposition. Dans ce scénario, il peut être préférable de limiter le service. Pour plus d’informations, consultez le [Modèle de limitation](http://msdn.microsoft.com/library/dn589798.aspx).
- À l’inverse, si vous avez besoin de la capacité de traiter toutes les demandes, lorsque le volume varie rapidement, et de coût n’est pas un facteur majeur, envisagez d’utiliser une stratégie agressive autoscaling qui démarre des instances supplémentaires plus rapidement. Vous pouvez également utiliser une stratégie de planification qui démarre un nombre suffisant d’instances pour répondre à la charge maximale avant cette charge est attendue.
- Le mécanisme d’autoscaling doit surveiller le processus autoscaling et consigner les détails de chaque événement autoscaling (ce qui a déclenchée, les ressources qui ont été ajoutés ou supprimés et quand). Si vous créez un mécanisme personnalisé autoscaling, assurez-vous qu’il intègre cette fonctionnalité. Analyser les informations qui permettent de mesurer l’efficacité de la stratégie autoscaling et un réglage si nécessaire. Vous pouvez optimiser à la fois à court terme, comme les modèles d’utilisation deviennent plus évidentes et sur le long terme, que l’entreprise se développe ou l’évoluent des exigences de l’application. Si une application atteint la limite supérieure définie pour autoscaling, le mécanisme d’alerte peut également un opérateur qui a pu démarrer manuellement des ressources supplémentaires si nécessaire. Notez que, dans ces circonstances, l’opérateur peut également être responsable de la suppression de ces ressources manuellement après que la charge de travail facilite.

## <a name="related-patterns-and-guidance"></a>Conseils et des modèles associés
Les modèles et les conseils suivants peuvent également être intéressant pour votre scénario lors de l’implémentation autoscaling :

- [La limitation du modèle](http://msdn.microsoft.com/library/dn589798.aspx). Ce modèle décrit comment une application peut continuer à fonctionner et de respecter les SLA lorsqu’une augmentation de la demande place une charge extrême sur les ressources. La limitation peut être utilisée avec autoscaling afin d’empêcher un système d’être submergé, tandis que le système peut évoluer.
- [Concurrents de motif de consommateurs](http://msdn.microsoft.com/library/dn568101.aspx). Ce modèle décrit comment implémenter un pool d’instances de service qui peuvent gérer les messages à partir de n’importe quelle instance de l’application. AutoScaling peut être utilisé pour démarrer et arrêter les instances de service pour le correspond à la charge de travail escomptée. Cette approche permet à un système à traiter plusieurs messages simultanément pour optimiser le débit, améliorer l’évolutivité et la disponibilité et équilibrer la charge de travail.
- [Instrumentation et télémétrie](http://msdn.microsoft.com/library/dn589775.aspx). Instrumentation et télémétrie sont essentielles pour la collecte des informations susceptibles de conduire le processus autoscaling.

## <a name="more-information"></a>Plus d’informations
- [Comment faire pour mettre à l’échelle une Application](./cloud-services/cloud-services-how-to-scale.md)
- [Redimensionner automatiquement une application Web rôles, rôles de travail ou ordinateurs virtuels en cours d’exécution](cloud-services-how-to-manage.md#linkresources)
- [Comment : lier une ressource à un service en nuage](cloud-services-how-to-manage.md#linkresources)
- [Mettre à l’échelle les ressources liées](./cloud-services/cloud-services-how-to-scale.md#scale-link-resources)
- [Bibliothèque de gestion des Services de surveillance de Azure](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring)
- [Gestion des services Azure API REST](http://msdn.microsoft.com/library/azure/ee460799.aspx)
- [Azure API REST de gestionnaire de ressources](https://msdn.microsoft.com/library/azure/dn790568.aspx)
- [Bibliothèque de Microsoft Insights](https://www.nuget.org/packages/Microsoft.Azure.Insights/)
- [Opérations sur Autoscaling](http://msdn.microsoft.com/library/azure/dn510374.aspx)
- [Microsoft.WindowsAzure.Management.Monitoring.Autoscale Namespace](http://msdn.microsoft.com/library/azure/microsoft.windowsazure.management.monitoring.autoscale.aspx)
