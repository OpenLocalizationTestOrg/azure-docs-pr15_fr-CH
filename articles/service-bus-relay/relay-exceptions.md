<properties 
    pageTitle="Exceptions de relais | Microsoft Azure"
    description="Liste des exceptions de relais et les actions suggérées."
    services="service-bus"
    documentationCenter="na"
    authors="jtaubensee"
    manager="timlt"
    editor="tysonn" />
<tags 
    ms.service="service-bus"
    ms.devlang="na"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.workload="na"
    ms.date="10/28/2016"
    ms.author="jotaub" />

# <a name="relay-exceptions"></a>Exceptions de relais

Cet article répertorie certaines exceptions générées par les API de relais Microsoft Azure. Cette référence est sujette à modification, reportez-vous à des mises à jour.

## <a name="exception-categories"></a>Catégories d’exceptions

Les API de relais génèrent des exceptions qui peuvent se trouvent dans les catégories suivantes, ainsi que l’action associée, que vous pouvez prendre pour essayer de les résoudre.

1.  Code d’erreur ([System.ArgumentException](https://msdn.microsoft.com/library/system.argumentexception.aspx), [System.InvalidOperationException](https://msdn.microsoft.com/library/system.invalidoperationexception.aspx), [System.OperationCanceledException](https://msdn.microsoft.com/library/system.operationcanceledexception.aspx), [System.Runtime.Serialization.SerializationException](https://msdn.microsoft.com/library/system.runtime.serialization.serializationexception.aspx)) de l’utilisateur. Action générale : essayer de corriger le code avant de continuer.

2.  Erreur d’installation/de configuration ([Microsoft.ServiceBus.Messaging.MessagingEntityNotFoundException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingentitynotfoundexception.aspx), [System.UnauthorizedAccessException](https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx). Action générale : passez en revue votre configuration et modifier, si nécessaire.

3.  Exceptions transitoire ([Microsoft.ServiceBus.Messaging.MessagingException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingexception.aspx), [Microsoft.ServiceBus.Messaging.ServerBusyException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.serverbusyexception.aspx), [Microsoft.ServiceBus.Messaging.MessagingCommunicationException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingcommunicationexception.aspx)). Action générale : recommencer l’opération ou avertir les utilisateurs.

4.  Autres exceptions ([System.Transactions.TransactionException](https://msdn.microsoft.com/library/system.transactions.transactionexception.aspx), [System.TimeoutException](https://msdn.microsoft.com/library/system.timeoutexception.aspx), [Microsoft.ServiceBus.Messaging.MessageLockLostException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagelocklostexception.aspx), [Microsoft.ServiceBus.Messaging.SessionLockLostException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.sessionlocklostexception.aspx)). Action générale : spécifique pour le type d’exception ; consultez le tableau dans la section suivante. 

## <a name="exception-types"></a>Types d’exception

Le tableau suivant répertorie les types d’exception messagerie et leurs causes et action suggérée de notes que vous pouvez prendre.

| **Type d’exception**                                                                                                                                                                                                                                                                                | **Description/causes/Examples**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | **Action suggérée**                                                                                                                                                                                                                                                                                                                                                                                                          | **Remarque sur la nouvelle tentative automatique et immédiat**                                                                                             |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
| [Exception TimeoutException](https://msdn.microsoft.com/library/system.timeoutexception.aspx)                                                                                                                                                                                                           | Le serveur n’a pas répondu à l’opération demandée dans le délai spécifié, qui est contrôlée par [OperationTimeout](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingfactorysettings.operationtimeout.aspx). Le serveur peut avoir terminé l’opération demandée. Cela peut se produire en raison de réseau ou d’autres délais de l’infrastructure.                                                                                                                                                                                                                                                                   | Vérifier la cohérence de l’état du système et recommencer si nécessaire. Voir les [exceptions d’expiration](#timeoutexception).                                                                                                                                                                                                                                                                                                                                                           | Nouvelle tentative peut aider dans certains cas ; Ajouter une logique de nouvelle tentative au code.                                                                      |
| [InvalidOperationException](https://msdn.microsoft.com/library/system.invalidoperationexception.aspx)                                                                                                                                                                                         | L’opération de l’utilisateur demandé n’est pas autorisée dans le serveur ou le service. Consultez le message d’exception pour plus de détails. Par exemple, [complète](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.brokeredmessage.complete.aspx) génère cette exception si le message a été reçu en mode de **ReceiveAndDelete** .                                                                                                                                                                                                                                                                                                     | Vérifiez le code et la documentation. Assurez-vous que l’opération demandée est valide.                                                                                                                                                                                                                                                                                                                                         | Ne permettra pas de nouvelle tentative.                                                                                                          |
| [OperationCanceledException](https://msdn.microsoft.com/library/system.operationcanceledexception.aspx)                                                                                                                                                                                       | Une tentative est effectuée pour appeler une opération sur un objet qui a déjà été fermé, abandonnée ou supprimé. Dans de rares cas, la transaction ambiante est déjà supprimée.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Vérifiez le code et assurez-vous qu’il n’appelle pas d’opérations sur un objet supprimé.                                                                                                                                                                                                                                                                                                                                          | Ne permettra pas de nouvelle tentative.                                                                                                          |
| [UnauthorizedAccessException](https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx)                                                                                                                                                                                     | L’objet [TokenProvider a](https://msdn.microsoft.com/library/azure/microsoft.servicebus.tokenprovider.aspx) n’a pas pu obtenir un jeton, le jeton n’est pas valide, ou le jeton ne contient-elle pas les déclarations requises pour effectuer l’opération.                                                                                                                                                                                                                                                                                                                                                                                                  | Assurez-vous que le fournisseur de jetons est créé avec les valeurs correctes. Vérifiez la configuration du service de contrôle d’accès.                                                                                                                                                                                                                                                                                                   | Nouvelle tentative peut aider dans certains cas ; Ajouter une logique de nouvelle tentative au code.                                                                      |
| [ArgumentException](https://msdn.microsoft.com/library/system.argumentexception.aspx)<br /> [ArgumentNullException](https://msdn.microsoft.com/library/system.argumentnullexception.aspx)<br />[ArgumentOutOfRangeException](https://msdn.microsoft.com/library/system.argumentoutofrangeexception.aspx) | Un ou plusieurs des arguments fournis à la méthode ne sont pas valides.<br /> L’URI fourni à [NamespaceManager](https://msdn.microsoft.com/library/azure/microsoft.servicebus.namespacemanager.aspx) ou [créer](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingfactory.create.aspx) contient des segments de chemin d’accès.<br /> Le modèle de l’URI fourni à [NamespaceManager](https://msdn.microsoft.com/library/azure/microsoft.servicebus.namespacemanager.aspx) ou [créer](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingfactory.create.aspx) n’est pas valide. <br />La valeur de la propriété est supérieure à 32 Ko. | Vérifiez le code appelant et assurez-vous que les arguments sont corrects.                                                                                                                                                                                                                                                                                                                                                           | Ne permettra pas de nouvelle tentative.                                                                                                          |
| [ServerBusyException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.serverbusyexception.aspx)                                                                                                                                                                       | Service n’est pas en mesure de traiter la demande pour l’instant.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Client peut attendre un certain temps, puis recommencez l’opération.                                                                                                                                                                                                                                                                                                                                                           | Client peut réessayer après un certain intervalle. Si une nouvelle tentative entraîne une exception différente, vérifiez le comportement des nouvelles tentatives de cette exception. |
| [QuotaExceededException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.quotaexceededexception.aspx)                                                                                                                                                                 | L’entité de messagerie a atteint sa taille maximale.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | Créer l’espace de l’entité en recevant des messages de l’entité ou de ses files d’attente secondaires. Voir [QuotaExceededException](#quotaexceededexception).                                                                                                                                                                                                                                                                                                                                      | Nouvelle tentative peut être utile si les messages ont été supprimés dans l’intervalle.                                                               |
| [MessageSizeExceededException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagesizeexceededexception.aspx)                                                                                                                                                     | Une charge utile du message dépasse la limite de 256 Ko. Notez que la limite de 256 Ko est la taille totale du message, qui peut inclure des propriétés système et toute surcharge .NET.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Réduire la taille de la charge utile du message, puis recommencez l’opération.                                                                                                                                                                                                                                                                                                                                                         | Ne permettra pas de nouvelle tentative.                                                                                                          |

## <a name="quotaexceededexception"></a>QuotaExceededException

[QuotaExceededException](https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.quotaexceededexception.aspx) indique qu’un quota pour une entité spécifique a été dépassé.

Pour prendre le relais, cette exception encapsule le [System.ServiceModel.QuotaExceededException](https://msdn.microsoft.com/library/system.servicemodel.quotaexceededexception.aspx), indiquant que le nombre maximal de récepteurs a été dépassé pour ce point de terminaison. Cela est indiqué dans la valeur de **MaximumListenersPerEndpoint** de message de l’exception.

## <a name="timeoutexception"></a>Exception TimeoutException 

Une [exception TimeoutException](https://msdn.microsoft.com/library/system.timeoutexception.aspx) indique qu’une opération initiée par l’utilisateur est en cours dépasse le délai d’expiration de l’opération. 

Vous devez vérifier la valeur de la propriété [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit) , comme l’atteinte de la limite peut également provoquent [l’exception TimeoutException](https://msdn.microsoft.com/library/system.timeoutexception.aspx).

Pour prendre le relais, vous pouvez recevoir des exceptions de dépassement de délai lors de la première ouverture d’une connexion de l’expéditeur de relais. Il existe deux causes courantes pour cette exception :

1. La valeur de [OpenTimeout](https://msdn.microsoft.com/library/wcf.opentimeout.aspx) peut être trop petite (y compris une fraction de seconde).
2. Le listener(s) de relais local peut ne pas être réactif (ou peut-être rencontrer des problèmes de règles de pare-feu interdisant les écouteurs d’accepter de nouvelles connexions client), et la valeur de [OpenTimeout](https://msdn.microsoft.com/library/wcf.opentimeout.aspx) est inférieure à environ 20 secondes.

Par exemple :

```
'System.TimeoutException’: The operation did not complete within the allotted timeout of 00:00:10. The time allotted to this operation may have been a portion of a longer timeout.
```

### <a name="common-causes"></a>Causes courantes

Il existe deux causes courantes de cette erreur : une configuration incorrecte ou une erreur de service temporaire.

1. **Configuration incorrecte** 
    le délai de l’opération peut être trop petit pour la condition de fonctionnement. La valeur par défaut pour le délai d’expiration de l’opération dans le Kit de développement logiciel du client est de 60 secondes. Vérifiez pour voir si votre code possède la valeur définie sur une valeur trop petite. Notez que la condition du réseau et de l’utilisation du processeur peut affecter le temps que nécessaire pour une opération particulière, afin que le délai d’expiration de l’opération ne doit pas être définie avec une valeur très faible.

2. **Erreur du service transitoire** 
    parfois de relais peuvent subir des retards dans le traitement des demandes ; par exemple, pendant les périodes de trafic élevé. Dans ce cas, vous pouvez réessayer l’opération après un certain temps, jusqu'à ce que l’opération est réussie. Si la même opération échoue encore après plusieurs tentatives, visitez le [site état de service Azure](https://azure.microsoft.com/status/) pour voir s’il existe des interruptions du service connu.

## <a name="next-steps"></a>Étapes suivantes :

- [Forum aux questions de relais](relay-faq.md)
- [Créer un espace de noms](relay-create-namespace-portal.md)
- [Mise en route de .NET](relay-hybrid-connections-dotnet-get-started.md)
- [Mise en route de nœud](relay-hybrid-connections-node-get-started.md)